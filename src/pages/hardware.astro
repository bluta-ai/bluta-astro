---
import "../styles/global.css";
import { Image } from "astro:assets";

import iaqSensor from "../assets/bluta-iaq-sensor.webp";
import heatmapFusion from "../assets/bluta-heatmap-fusion-sensor.webp";
import heatmapPro from "../assets/bluta-heatmap-pro.webp";
import ifLogo from "../assets/if-Design-Award.webp";
import ioBox from "../assets/bluta-io-box.webp";
import waterLeakge from "../assets/bluta-water-leakage-sensor.webp";
import infoStation from "../assets/bluta-info-station.webp";

const formspreeId = 'xyznyolp';

// Product data
const products = [
  {
    title: "Air Quality Sensor",
    tags: ["HVAC", "iF DESIGN AWARD Winner"],
    award: true,
    img: iaqSensor,
    desc:
      "Measuring different air parameters to instant control HVAC and optimize energy usage. The AI edge computing empower the sensor to detect smoking and vaping.",
    specs: [
      ["Special Feature", "Smoking and vaping Detection by AI"],
      ["Parameters", "CO₂, PM₂.₅/PM₁₀, TVOC, temperature, humidity, H₂S, NH₃"],
      ["Connectivity", "LoRaWAN"],
      ["Data Protocal", "MQTT/HTTPS"],
    ],
  },
  {
    title: "Heatmap Fusion",
    tags: ["AI Sensing","Accident Prevention"],
    img: heatmapFusion,
    desc:
      "Sensor fusion for people presence and safety without personal identifiers.",
    specs: [
      ["Special Feature", "Thermal + mmWave AI sensor fusion with edge computing"],
      ["Privacy", "No personal identifiers revealed"],
      ["Outputs", "Occupancy, Long Stay, No Motion, Fall, Fire, People Count"],
      ["Connectivity", "LoRaWAN & Wi-Fi; optional Bluetooth for local control"],
    ],
  },
  {
    title: "Heatmap Pro",
    tags: ["Accident Prevention","iF DESIGN AWARD Winner"],
    award: true,
    img: heatmapPro,
    desc:
      "Accident prevention and people-flow analytics with privacy-first signals.",
    specs: [
      ["Special Feature", "16 x 12 thermal grid sensor to ensure only living object is being detected"],
      ["Privacy", "No personal identifiers revealed"],
      ["Outputs", "Occupancy, Long Stay, No Motion, Fire, People Count"],
      ["Connectivity", "LoRaWAN & Wi-Fi; optional Bluetooth for local control"],
    ],
  },
  // Example external-image cards (remove or replace as you like)
  {
    title: "BLUTA I/O Box",
    tags: ["Edge computing", "Instant Control"],
    img: ioBox,
    desc:
      "Secures, normalises and bridges legacy protocols into the Multi-Control Protocol (MCP).",
    specs: [
      ["Special Feature", "Convert between different protocals, Standardise data format, collect data to feed into AI"],
      ["Protocols", "LoRaWAN, Dry Contact, RS485, RS232, Bluetooth, MQTT, BacNET, Modbus"],
      ["Security", "TLS, signed configs, local RBAC"],
      ["Power Suply", "12DC or battery power"],
    ],
  },
  {
    title: "Water Leakage Sensor",
    tags: ["Water Leakge","Preventive Maintenance"],
    img: waterLeakge,
    desc:
      "Asthetically designed water leakge sensor with high accuracy .",
    specs: [
      ["Special Feature", "Using titanium probe to improve accuracy and avoid copper rust"],
      ["Protocols", "LoRaWAN, 4G"],
      ["Waterproof", "IP67"],
      ["Mount", "Floor mount or wall mount with invisible bracket"],
    ],
  },

  {
    title: "Info Station",
    tags: ["Smart Washroom","Display"],
    img: infoStation,
    desc:
      "World known design award winning display playing with the trick with reflective coating",
    specs: [
      ["Special Feature", "With built-in content publishing system"],
      ["Job References", "IFC Mall, Metroplaza, KTR350, etc"],
      ["Integration", "Pulling content and information from BLUTA"],
      ["Mount", "Wall mounted with power supply"],
    ],
  },
];
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>BLUTA — Hardware</title>
    <meta
      name="description"
      content="Privacy-first sensors and gateways that unify signals for building automation and insights."
    />
  </head>
  <body>
    <!-- NAV -->
    <div class="nav">
      <div class="container nav-inner">
        <a href="/" class="brand" aria-label="bluta home">
          <span class="wordmark"><span class="blu">blu</span><span class="ta">ta</span></span>
        </a>
        <div class="nav-links">
          <a href="/">Home</a>
          <a href="/solutions">Solutions</a>
          <a class="active" href="/hardware">Hardware</a>
          <a href="/projects">Projects</a>
          <a href="/#contact">Contact</a>
        </div>
      </div>
    </div>

    <!-- HERO (compact) -->
    <section class="hero hero-small">
      <div class="hero-overlay">
        <div class="content container">
          <h1 class="h1">BLUTA Hardware</h1>
          <p class="lead">
            Privacy-first sensors and gateways that unify signals for building automation and insights.
          </p>
        </div>
      </div>
    </section>

    <!-- RESPONSIVE PRODUCT GRID -->
    <section>
      <div class="container cards">
        {
          products.map((p) => (
            <article class="card" style="overflow:hidden">
              <!-- product image -->
              <div class="image" style="height: 340px">
                {
                  p.img ? (
                    <Image
                      src={p.img}
                      alt={p.title}
                      widths={[480, 720, 1080]}
                      sizes="(max-width: 980px) 100vw, 520px"
                      format="webp"
                      style="width:100%;height:100%;object-fit:cover"
                      loading="lazy"
                      decoding="async"
                    />
                  ) : (
                    <img
                      src={p.imgUrl}
                      alt={p.title}
                      style="width:100%;height:100%;object-fit:cover"
                      loading="lazy"
                    />
                  )
                }
              </div>

              <!-- header: left (pills + title), right (award mark if any) -->
              <div class="p-6">
                <div class="card-head">
                  <div class="card-head-left">
                    <div class="pill-row">
                      {p.tags.map((t) => <div class="pill">{t}</div>)}
                    </div>
                    <h2 class="h2" style="margin-top:8px">{p.title}</h2>
                  </div>

                  {p.award && (
                    <Image src={ifLogo} alt="iF DESIGN AWARD" width={40} height={40} class="if-mark" />
                  )}
                </div>

                <p class="muted" style="margin-top:6px">{p.desc}</p>

                <table class="specs">
                  <tbody>
                    {p.specs.map(([k, v]) => (
                      <tr><td>{k}</td><td set:html={v} /></tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </article>
          ))
        }
      </div>
    </section>

    <!-- CTA (modal trigger) -->
    <section>
      <div class="container">
        <div class="card p-6" style="background:linear-gradient(135deg,rgba(167,139,250,.15),rgba(0,195,216,.15))">
          <div class="grid col-2" style="align-items:center">
            <div>
              <div class="h2">Have a similar site?</div>
              <p class="muted">Send us your floor area, number of AHUs, and systems used. We’ll reply with a proposed scope and ROI estimate.</p>
            </div>
            <div style="text-align:right">
              <a href="#demo" class="btn primary js-request-demo">Request a Demo</a>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- FOOTER -->
    <section id="contact">
      <div class="container">
        <div class="footer">
          <div class="grid col-3">
            <div>
              <div class="brand">
                <span class="wordmark"><span class="blu">blu</span><span class="ta">ta</span></span>
                <span class="muted" style="margin-left:8px">by Blutech.io</span>
              </div>
              <p class="muted" style="font-size:14px;margin-top:8px">
                Physical AI for smart buildings. Privacy-first sensors and gateways that unify data for action.
              </p>
              <div class="muted">© <span id="y"></span> Blutech IoT Limited</div>
            </div>
            <div>
              <div style="font-weight:800">Explore</div>
              <div><a href="/solutions" class="muted">Solutions</a></div>
              <div><a href="/hardware" class="muted">Hardware</a></div>
              <div><a href="/projects" class="muted">Projects</a></div>
            </div>
            <div>
              <div style="font-weight:800">Contact</div>
              <div><a href="mailto:enquiry@blutech.io" class="muted">enquiry@blutech.io</a></div>
            </div>
          </div>
        </div>
      </div>
    </section>

    <!-- Year -->
    <script>
      (function(){const y=document.getElementById('y'); if(y) y.textContent=String(new Date().getFullYear());})();
    </script>

    <!-- Demo Modal (Formspree) -->
    <div id="demo-modal" class="modal hidden" aria-hidden="true" role="dialog" aria-modal="true" aria-labelledby="demo-title">
      <div class="modal-backdrop js-close-demo" aria-hidden="true"></div>

      <div class="modal-panel" role="document">
        <button class="modal-close js-close-demo" aria-label="Close">✕</button>

        <h3 id="demo-title" class="modal-title">Request a demo</h3>
        <p class="modal-sub">Leave your details and questions—we’ll reach out shortly.</p>

        <form id="demo-form" class="demo-form" action={`https://formspree.io/f/${formspreeId}`} method="POST" novalidate>
          <input type="text" name="_gotcha" style="display:none">

          <div class="field">
            <label for="demo-name">Name</label>
            <input id="demo-name" name="name" type="text" required placeholder="Your name">
          </div>

          <div class="field">
            <label for="demo-email">Email</label>
            <input id="demo-email" name="email" type="email" required placeholder="you@example.com">
          </div>

          <div class="field">
            <label for="demo-company">Company (optional)</label>
            <input id="demo-company" name="company" type="text" placeholder="Company">
          </div>

          <div class="field">
            <label for="demo-msg">Your question</label>
            <textarea id="demo-msg" name="message" rows="4" required placeholder="Tell us about your building and goals…"></textarea>
          </div>

          <input type="hidden" name="_subject" value="BLUTA — Demo request">
          <input type="hidden" name="page" value="/hardware">

          <button type="submit" class="btn primary" style="width:100%">Send request</button>
          <p class="form-hint">We’ll reply within 1–2 business days.</p>
        </form>
      </div>
    </div>

    <!-- Modal JS (place AFTER modal HTML) -->
    <script>
      (function(){
        const modal  = document.getElementById('demo-modal');
        if (!modal) return;

        const openers = document.querySelectorAll('.js-request-demo');
        const closers = modal.querySelectorAll('.js-close-demo');
        const panel   = modal.querySelector('.modal-panel');
        const form    = modal.querySelector('#demo-form');

        function open(e){ if(e) e.preventDefault(); modal.classList.remove('hidden'); document.body.classList.add('modal-open'); (modal.querySelector('input,textarea,button')||{}).focus?.(); }
        function close(){ modal.classList.add('hidden'); document.body.classList.remove('modal-open'); }

        openers.forEach(b => b.addEventListener('click', open));
        closers.forEach(b => b.addEventListener('click', close));
        modal.addEventListener('click', e => { if (!panel.contains(e.target)) close(); });
        document.addEventListener('keydown', e => { if (e.key === 'Escape' && !modal.classList.contains('hidden')) close(); });

        // Submit to Formspree (AJAX)
        form?.addEventListener('submit', async (e) => {
          e.preventDefault();
          const btn = form.querySelector('button[type="submit"]');
          btn && (btn.disabled = true);
          try {
            const res = await fetch(form.action, {
              method: 'POST',
              body: new FormData(form),
              headers: { 'Accept': 'application/json' }
            });
            if (res.ok) {
              form.reset(); close();
              alert('Thanks! We’ll contact you shortly.');
            } else {
              alert('Sorry, something went wrong. Please try again.');
            }
          } catch (err) {
            alert('Network error. Please try again.');
          } finally {
            btn && (btn.disabled = false);
          }
        });
      })();
    </script>

    <!-- Page-only styles (grid + header row). Modal CSS lives in global.css -->
    <style>
      /* 1 col (mobile) → 2 cols (tablet) → 3 cols (desktop max) */
.cards{
  display:grid;
  gap:22px; /* tweak spacing if you like */
  grid-template-columns: repeat(auto-fit, minmax(360px, 1fr));
}

/* Force exactly 2 cols on mid screens if you want tighter control */
@media (min-width: 720px){
  .cards{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
}

/* Max out at 3 columns on desktop */
@media (min-width: 1080px){
  .cards{ grid-template-columns: repeat(3, minmax(0, 1fr)); }
}

      

      /* Equal heights per row */
      .cards > .card{ height:100%; display:flex; flex-direction:column; }
      .cards > .card .p-6{ flex:1; }

      /* Card header row */
      .card-head{ display:flex; align-items:center; justify-content:space-between; gap:12px; }
      .card-head-left{ min-width:0; }
      .pill-row{ display:flex; align-items:center; gap:8px; flex-wrap:wrap; }

      /* iF mark on right */
      .if-mark{ width:40px; height:40px; border-radius:0px; flex:0 0 auto; opacity:.95; }
      @media (max-width:640px){ .if-mark{ width:28px; height:28px; } }

      /* If your global .pill exists, it will apply. If not, this is safe: */
      .pill{ display:inline-flex; align-items:center; gap:6px; padding:4px 10px; border-radius:999px; font-size:13px; font-weight:600; line-height:1; }
      .award-if{ background:rgba(255,59,48,.12); border:1px solid rgba(255,59,48,.35); }
    </style>
  </body>
</html>
